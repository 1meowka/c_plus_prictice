#define RED 0
#define YELLOW 1
#define GREEN 2
#define BUTTON_PIN 3

int currentColor = RED;

void setup() {
  pinMode(RED, OUTPUT);
  pinMode(YELLOW, OUTPUT);
  pinMode(GREEN, OUTPUT);
  pinMode(BUTTON_PIN, INPUT_PULLUP);

  // устанавливаем прерывание на пине BUTTON_PIN
  attachInterrupt(digitalPinToInterrupt(BUTTON_PIN), changeColor, FALLING);
}

void loop() {
  
}

void changeColor() {
  noInterrupts(); // Отключаем прерывания временно

  digitalWrite(currentColor, LOW);  // 
    
  if (currentColor == RED) {
    currentColor = YELLOW;
  } else if (currentColor == YELLOW) {
    currentColor = GREEN;
  } else {
    currentColor = RED;
  }
    
  digitalWrite(currentColor, HIGH); // включаем новый цвет
  delay(500); //

  interrupts(); // включаем прерывания снова
}
