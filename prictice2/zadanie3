#include <AmperkaFET.h>
#include <SPI.h>

AmperkaFET pFET; // Подключение силовых ключей
AmperkaFET nFET;

void setup() {
  SPI.begin(); // Настройка шины SPI
  SPI.setClockDivider(SPI_CLOCK_DIV8); // Установите необходимую частоту SPI
  pinMode(SS, OUTPUT);

  pFET.begin(FET_P, 3); // Замените "3" на номер GPIO, к которому подключен P-FET
  nFET.begin(FET_N, 4); // Замените "4" на номер GPIO, к которому подключен N-FET

  Serial.begin(9600); // скорость передачи данных
}

void loop() {
  // чтение данных из Serial и отправка команд через SPI
  if (Serial.available() > 0) {
    char command = Serial.read();
    switch (command) {
      case '1':
        pFET.turnOn();
        nFET.turnOff();
        break;
      case '0':
        pFET.turnOff();
        nFET.turnOn();
        break;
      default:
        pFET.turnOff();
        nFET.turnOff();
        break;
    }
  }
}
